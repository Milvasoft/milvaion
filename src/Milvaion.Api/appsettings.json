{
  "ConnectionStrings": {
    "DefaultConnectionString": "Host=postgres;Port=5432;Database=MilvaionDb;Username=postgres;Password=N4SQp.qW>6?xwWzg;Pooling=true;Minimum Pool Size=20;Maximum Pool Size=100;Connection Lifetime=900;Connection Idle Lifetime=180;Command Timeout=30;Include Error Detail=true"
  },
  "Cors": {
    "DefaultPolicy": "AllowAll",
    "Policies": {
      "AllowAll": {
        "AllowAnyOriginWithCredentials": true,
        "Origins": [ "All" ],
        "Methods": [ "All" ],
        "Headers": [ "All" ],
        "ExposedHeaders": [ "Content-Disposition" ],
        "AllowCredentials": false
      }
    }
  },
  "MilvaionConfig": {
    "Logging": {
      "Seq": {
        "Enabled": true,
        "Uri": "http://seq:5341"
      }
    },
    "OpenTelemetry": {
      "Enabled": true,
      "ExportPath": "/api/metrics",
      "Service": "milvaion-backend",
      "Environment": "milvaion-test",
      "Job": "app-metrics",
      "Instance": "milvaion-test"
    },
    "Redis": {
      "ConnectionString": "redis:6379",
      "Password": "",
      "Database": 0,
      "ConnectTimeout": 5000,
      "SyncTimeout": 5000,
      "KeyPrefix": "Milvaion:JobScheduler:",
      "DefaultLockTtlSeconds": 600
    },
    "RabbitMQ": {
      "Host": "rabbitmq",
      "Port": 5672,
      "Username": "guest",
      "Password": "guest",
      "VirtualHost": "/",
      "Durable": true,
      "AutoDelete": false,
      "ConnectionTimeout": 30,
      "Heartbeat": 60,
      "AutomaticRecoveryEnabled": true,
      "NetworkRecoveryInterval": 10,
      "QueueDepthWarningThreshold": 100,
      "QueueDepthCriticalThreshold": 500
    },
    "JobDispatcher": {
      "Enabled": true,
      "PollingIntervalSeconds": 1,
      "BatchSize": 100,
      "LockTtlSeconds": 600,
      "EnableStartupRecovery": true
    },
    "WorkerAutoDiscovery": {
      "Enabled": true
    },
    "ZombieOccurrenceDetector": {
      "Enabled": true,
      "CheckIntervalSeconds": 300,
      "ZombieTimeoutMinutes": 10
    },
    "LogCollector": {
      "Enabled": true,
      "BatchSize": 100,
      "BatchIntervalMs": 1000
    },
    "StatusTracker": {
      "Enabled": true,
      "BatchSize": 50,
      "BatchIntervalMs": 100,
      "ExecutionLogMaxCount" : 100
    },
    "FailedOccurrenceHandler": {
      "Enabled": true
    },
    "JobAutoDisable": {
      "Enabled": true,
      "ConsecutiveFailureThreshold": 5,
      "FailureWindowMinutes": 60,
      "AutoReEnableAfterCooldown": false,
      "AutoReEnableCooldownMinutes": 30
    }
  },
  "Milvasoft": {
    "Localization": {
      "Resx": {
        "ManagerLifetime": 2, //Transient
        "KeyFormat": "{0}",
        "KeyFormatDelegate": null,
        "UseInMemoryCache": true,
        "MemoryCacheEntryOptions": null,
        "ResourcesPath": null,
        "ResourcesFolderPath": null
      },
      "Redis": {
        "ManagerLifetime": 2, //Transient
        "KeyFormat": "_ML_{0}_{1}",
        "KeyFormatDelegate": null,
        "UseInMemoryCache": true,
        "MemoryCacheEntryOptions": null,
        "ResourcesPath": null,
        "ResourcesFolderPath": null,
        "RedisOptions": {
          "AccessorLifetime": 0, //Singleton
          "ConnectionString": "redis",
          "UseUtcForExpirationDates": false
        }
      }
    },
    "Interception": {
      "Log": {
        "InterceptorLifetime": 1, //Scoped
        "AsyncLogging": true,
        "LogDefaultParameters": true,
        "UseUtcForLogTimes": true,
        "ExcludeResponseMetadataFromLog": true,
        "ExtraLoggingPropertiesSelector": null
      },
      "Response": {
        "InterceptorLifetime": 1, //Scoped
        "MetadataCreationEnabled": true,
        "ApplyMetadataRules": true,
        "TranslateResultMessages": true,
        "TranslateMetadata": true,
        "HideByRoleFunc": null,
        "ApplyLocalizationFunc": null
      },
      "Cache": {
        "InterceptorLifetime": 1, //Scoped
        //"CacheAccessorAssemblyQualifiedName": "Milvasoft.Caching.InMemory.Accessor.MemoryCacheAccessor, Milvasoft.Caching.InMemory, Version=8.1.9.0, Culture=neutral, PublicKeyToken=null",
        "IncludedRequestHeaderKeys": [ "accept-language" ]
      },
      "Transaction": {
        "InterceptorLifetime": 1, //Scoped
        "DbContextAssemblyQualifiedName": "Milvaion.Infrastructure.Persistence.Context.MilvaionDbContext, Milvaion.Infrastructure, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null"
      },
      "WithNoLock": {
        "InterceptorLifetime": 1, //Scoped
        "DbContextAssemblyQualifiedName": "Milvaion.Infrastructure.Persistence.Context.MilvaionDbContext, Milvaion.Infrastructure, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null"
      }
    },
    "Caching": {
      "Redis": {
        "AccessorLifetime": 0, //Singleton
        "ConnectionString": "redis",
        "UseUtcForExpirationDates": false
      },
      "InMemory": {
        "AccessorLifetime": 0, //Singleton
        "MemoryCacheOptions": null
      }
    },
    "FileOperations": {
      "Json": {
        "Lifetime": 0, //Singleton
        "BasePath": null,
        "EncryptionKey": "w!z%C*F-JaNdRgUk",
        "CultureCode": "en-US"
      }
    },
    "DataAccess": {
      "DbContext": {
        "DynamicFetch": {
          "EntityAssemblyName": "Milvaion.Domain",
          "AllowedEntityNamesForLookup": [ "User", "Role", "ScheduledJob", "JobOccurrence" ],
          "MaxAllowedPropertyCountForLookup": 5
        },
        "UseUtcForDateTime": true,
        "DefaultSoftDeletionState": 0, // Passive
        "GetCurrentUserNameDelegate": null
      },
      "Repository": {
        "DefaultSaveChangesChoice": 0, // AfterEveryOperation
        "DefaultSoftDeletedFetchState": false,
        "ResetSoftDeletedFetchStateToDefault": true
      },
      "Auditing": {
        "AuditCreationDate": true,
        "AuditCreator": true,
        "AuditModificationDate": true,
        "AuditModifier": true,
        "AuditDeletionDate": true,
        "AuditDeleter": true
      }
    },
    "Identity": {
      "User": {
        "AllowedUserNameCharacters": "abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789-._@+",
        "RequireUniqueEmail": false
      },
      "Password": {
        "Hasher": {
          "IterationCount": 10000
        },
        "RequiredLength": 6,
        "RequiredUniqueChars": 1,
        "RequireNonAlphanumeric": true,
        "RequireLowercase": true,
        "RequireUppercase": true,
        "RequireDigit": true
      },
      "Lockout": {
        "AllowedForNewUsers": true,
        "MaxFailedAccessAttempts": 5,
        "DefaultLockoutTimeSpan": 5
      },
      "SignIn": {
        "RequireConfirmedEmail": false,
        "RequireConfirmedPhoneNumber": false
      },
      "Token": {
        "UseUtcForDateTimes": true,
        "ExpirationMinute": 90,
        "TokenValidationParameters": {
          "ValidateIssuer": false,
          "ValidateAudience": false
        },
        "SecurityKeyType": 0, // Symmetric
        "SymmetricPublicKey": "9321acf6145bc0a5d573a835be473682992d17a17830de85a122c715633ae5e9"
      }
    }
  },
  "Serilog": {
    "Using": [ "Serilog.Expressions", "Serilog.Sinks.Console" ],
    "MinimumLevel": {
      "Default": "Debug",
      "Override": {
        "Microsoft.AspNetCore": "Information",
        "System": "Warning",
        "Microsoft.AspNetCore.Mvc": "Warning",
        "Microsoft.AspNetCore.Cors": "Warning",
        "Microsoft.AspNetCore.Routing": "Warning",
        "Microsoft.AspNetCore.Hosting.Diagnostics": "Warning",
        "Microsoft.EntityFrameworkCore.Database.Command": "Warning",
        "Microsoft.EntityFrameworkCore.Update": "Warning",
        "Microsoft.AspNetCore.Authentication.JwtBearer.JwtBearerHandler": "Warning"
      }
    },
    "WriteTo": [
      {
        "Name": "Logger",
        "Args": {
          "configureLogger": {
            "WriteTo": [
              {
                "Name": "Console"
              }
            ]
          }
        }
      }
    ]
  }
}
