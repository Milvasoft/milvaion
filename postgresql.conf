# PostgreSQL Configuration - Optimized for Milvaion Job Scheduler
# Generated for 8GB RAM container, SSD storage

# ===========================
# MEMORY SETTINGS
# ===========================
shared_buffers = 2GB                     # 8GB * 0.25
effective_cache_size = 6GB               # 8GB * 0.75
maintenance_work_mem = 512MB
work_mem = 64MB

# ===========================
# CONNECTION SETTINGS
# ===========================
max_connections = 200

# ===========================
# WRITE-AHEAD LOG
# ===========================
wal_buffers = 16MB
wal_compression = on
checkpoint_completion_target = 0.9
max_wal_size = 2GB

# ===========================
# QUERY PLANNER (SSD OPTIMIZATION)
# ===========================
random_page_cost = 1.1                   # SSD (HDD default: 4.0)
effective_io_concurrency = 200           # SSD parallel I/O

# ===========================
# AUTOVACUUM (HIGH-CHURN WORKLOAD)
# ===========================
autovacuum = on
autovacuum_max_workers = 4
autovacuum_naptime = 10s
autovacuum_vacuum_scale_factor = 0.1
autovacuum_analyze_scale_factor = 0.05

# ===========================
# LOGGING
# ===========================
log_min_duration_statement = 1000        # Log slow queries (>1s)
log_checkpoints = on
log_connections = off
log_disconnections = off
log_lock_waits = on

# ===========================
# PERFORMANCE
# ===========================
max_parallel_workers_per_gather = 4
max_parallel_workers = 8
max_worker_processes = 8
